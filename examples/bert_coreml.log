WARNING:root:scikit-learn version 1.0 is not supported. Minimum required version: 0.17. Maximum required version: 0.19.2. Disabling scikit-learn conversion API.
WARNING:root:XGBoost version 1.5.0 has not been tested with coremltools. You may run into unexpected errors. XGBoost 1.4.2 is the most recent version that has been tested.
WARNING:root:TensorFlow version 2.8.0 has not been tested with coremltools. You may run into unexpected errors. TensorFlow 2.5.0 is the most recent version that has been tested.
WARNING:root:Keras version 2.8.0 has not been tested with coremltools. You may run into unexpected errors. Keras 2.2.4 is the most recent version that has been tested.
WARNING:root:Torch version 1.11.0a0+git313939c has not been tested with coremltools. You may run into unexpected errors. Torch 1.9.1 is the most recent version that has been tested.
WARNING:root:Tuple detected at graph output. This will be flattened in the converted model.
Converting Frontend ==> MIL Ops:   0%|          | 0/668 [00:00<?, ? ops/s]WARNING:root:CoreML embedding (gather) layer does not support any inputs besides the weights and indices. Those given will be ignored.
Converting Frontend ==> MIL Ops:  64%|██████▍   | 426/668 [00:00<00:00, 4235.45 ops/s]Converting Frontend ==> MIL Ops: 100%|█████████▉| 666/668 [00:00<00:00, 3421.67 ops/s]
Running MIL Common passes:   0%|          | 0/34 [00:00<?, ? passes/s]/Users/anush/miniforge3/lib/python3.9/site-packages/coremltools/converters/mil/mil/passes/name_sanitization_utils.py:129: UserWarning: Output, '1059', of the source model, has been renamed to 'var_1059' in the Core ML model.
  warnings.warn(msg.format(var.name, new_name))
Running MIL Common passes:  62%|██████▏   | 21/34 [00:00<00:00, 161.70 passes/s]Running MIL Common passes: 100%|██████████| 34/34 [00:00<00:00, 204.96 passes/s]
Running MIL FP16ComputePrecision pass:   0%|          | 0/1 [00:00<?, ? passes/s]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.19s/ passes]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.19s/ passes]
Running MIL Clean up passes:   0%|          | 0/9 [00:00<?, ? passes/s]Running MIL Clean up passes:  11%|█         | 1/9 [00:00<00:06,  1.29 passes/s]Running MIL Clean up passes:  22%|██▏       | 2/9 [00:01<00:03,  2.04 passes/s]Running MIL Clean up passes:  67%|██████▋   | 6/9 [00:01<00:00,  6.38 passes/s]Running MIL Clean up passes:  89%|████████▉ | 8/9 [00:02<00:00,  3.62 passes/s]Running MIL Clean up passes: 100%|██████████| 9/9 [00:02<00:00,  3.85 passes/s]
/Users/anush/miniforge3/lib/python3.9/site-packages/coremltools/converters/mil/backend/mil/passes/adjust_io_to_supported_types.py:88: UserWarning: Inputinput_ids is of dType int64. Only integer variables of bit width 32 are supported by the CoreML runtime. This input will be assigned a dType of int32. No cast will be inserted; the previous dtype will be replaced.
  _warnings.warn("Input" + input_var.name + " is of dType " + input_dtype_str +\
/Users/anush/miniforge3/lib/python3.9/site-packages/coremltools/converters/mil/backend/mil/passes/adjust_io_to_supported_types.py:88: UserWarning: Inputattention_mask is of dType int64. Only integer variables of bit width 32 are supported by the CoreML runtime. This input will be assigned a dType of int32. No cast will be inserted; the previous dtype will be replaced.
  _warnings.warn("Input" + input_var.name + " is of dType " + input_dtype_str +\
/Users/anush/miniforge3/lib/python3.9/site-packages/coremltools/converters/mil/backend/mil/passes/adjust_io_to_supported_types.py:151: UserWarning: Input35 is of dType int64. Only integer variables of bit width 32 are supported by the CoreML runtime. This input will be assigned a dType of int32. No cast will be inserted; the previous dtype will be replaced.
  _warnings.warn("Input" + var.name + " is of dType " + dtype_str +\
/Users/anush/miniforge3/lib/python3.9/site-packages/coremltools/converters/mil/backend/mil/passes/adjust_io_to_supported_types.py:151: UserWarning: Input37 is of dType int64. Only integer variables of bit width 32 are supported by the CoreML runtime. This input will be assigned a dType of int32. No cast will be inserted; the previous dtype will be replaced.
  _warnings.warn("Input" + var.name + " is of dType " + dtype_str +\
WARNING:root:Tuple detected at graph output. This will be flattened in the converted model.
Converting Frontend ==> MIL Ops:   0%|          | 0/668 [00:00<?, ? ops/s]WARNING:root:CoreML embedding (gather) layer does not support any inputs besides the weights and indices. Those given will be ignored.
Converting Frontend ==> MIL Ops:  61%|██████    | 408/668 [00:00<00:00, 4071.12 ops/s]Converting Frontend ==> MIL Ops: 100%|█████████▉| 666/668 [00:00<00:00, 3299.48 ops/s]
Running MIL Common passes:   0%|          | 0/34 [00:00<?, ? passes/s]Running MIL Common passes:  62%|██████▏   | 21/34 [00:00<00:00, 185.14 passes/s]Running MIL Common passes: 100%|██████████| 34/34 [00:00<00:00, 255.95 passes/s]
Running MIL FP16ComputePrecision pass:   0%|          | 0/1 [00:00<?, ? passes/s]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.18s/ passes]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.18s/ passes]
Running MIL Clean up passes:   0%|          | 0/9 [00:00<?, ? passes/s]Running MIL Clean up passes:  11%|█         | 1/9 [00:00<00:06,  1.30 passes/s]Running MIL Clean up passes:  22%|██▏       | 2/9 [00:01<00:03,  2.08 passes/s]Running MIL Clean up passes:  67%|██████▋   | 6/9 [00:01<00:00,  7.11 passes/s]Running MIL Clean up passes:  89%|████████▉ | 8/9 [00:02<00:00,  3.83 passes/s]Running MIL Clean up passes: 100%|██████████| 9/9 [00:02<00:00,  4.05 passes/s]
WARNING:root:Tuple detected at graph output. This will be flattened in the converted model.
Converting Frontend ==> MIL Ops:   0%|          | 0/668 [00:00<?, ? ops/s]WARNING:root:CoreML embedding (gather) layer does not support any inputs besides the weights and indices. Those given will be ignored.
Converting Frontend ==> MIL Ops:  62%|██████▏   | 414/668 [00:00<00:00, 4133.42 ops/s]Converting Frontend ==> MIL Ops: 100%|█████████▉| 666/668 [00:00<00:00, 3272.19 ops/s]
Running MIL Common passes:   0%|          | 0/34 [00:00<?, ? passes/s]Running MIL Common passes:  62%|██████▏   | 21/34 [00:00<00:00, 173.83 passes/s]Running MIL Common passes: 100%|██████████| 34/34 [00:00<00:00, 242.40 passes/s]
Running MIL FP16ComputePrecision pass:   0%|          | 0/1 [00:00<?, ? passes/s]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.24s/ passes]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.24s/ passes]
Running MIL Clean up passes:   0%|          | 0/9 [00:00<?, ? passes/s]Running MIL Clean up passes:  11%|█         | 1/9 [00:00<00:06,  1.33 passes/s]Running MIL Clean up passes:  22%|██▏       | 2/9 [00:01<00:03,  2.10 passes/s]Running MIL Clean up passes:  67%|██████▋   | 6/9 [00:01<00:00,  7.06 passes/s]Running MIL Clean up passes:  89%|████████▉ | 8/9 [00:02<00:00,  3.71 passes/s]Running MIL Clean up passes: 100%|██████████| 9/9 [00:02<00:00,  3.97 passes/s]
WARNING:root:Tuple detected at graph output. This will be flattened in the converted model.
Converting Frontend ==> MIL Ops:   0%|          | 0/668 [00:00<?, ? ops/s]WARNING:root:CoreML embedding (gather) layer does not support any inputs besides the weights and indices. Those given will be ignored.
Converting Frontend ==> MIL Ops:  54%|█████▍    | 360/668 [00:00<00:00, 3595.12 ops/s]Converting Frontend ==> MIL Ops: 100%|█████████▉| 666/668 [00:00<00:00, 2855.06 ops/s]
Running MIL Common passes:   0%|          | 0/34 [00:00<?, ? passes/s]Running MIL Common passes:  62%|██████▏   | 21/34 [00:00<00:00, 185.07 passes/s]Running MIL Common passes: 100%|██████████| 34/34 [00:00<00:00, 254.68 passes/s]
Running MIL FP16ComputePrecision pass:   0%|          | 0/1 [00:00<?, ? passes/s]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.22s/ passes]Running MIL FP16ComputePrecision pass: 100%|██████████| 1/1 [00:01<00:00,  1.22s/ passes]
Running MIL Clean up passes:   0%|          | 0/9 [00:00<?, ? passes/s]Running MIL Clean up passes:  11%|█         | 1/9 [00:00<00:06,  1.17 passes/s]Running MIL Clean up passes:  22%|██▏       | 2/9 [00:01<00:03,  1.82 passes/s]Running MIL Clean up passes:  67%|██████▋   | 6/9 [00:01<00:00,  6.06 passes/s]Running MIL Clean up passes:  89%|████████▉ | 8/9 [00:02<00:00,  3.51 passes/s]Running MIL Clean up passes: 100%|██████████| 9/9 [00:02<00:00,  3.66 passes/s]
/Users/anush/miniforge3/lib/python3.9/multiprocessing/resource_tracker.py:96: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
  warnings.warn('resource_tracker: process died unexpectedly, '
Exception ignored in: <function MLModel.__del__ at 0x170c45940>
Traceback (most recent call last):
  File "/Users/anush/miniforge3/lib/python3.9/site-packages/coremltools/models/model.py", line 297, in __del__
AttributeError: 'NoneType' object has no attribute 'rmtree'
